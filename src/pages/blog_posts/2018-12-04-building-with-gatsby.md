---
path: "/blog_posts/rebuilding-with-gatsby"
title: Rebuilding With Gatsby
author: "Mo"
image: '../../images/posts/hal-gatewood.jpg'
date: '2018-12-04'
---


## Before the Build
Back in August, the Apsis team met up in Seattle for a team retreat. We talked about everything from our bottlenecks to our financial model, with a level of extreme transparency I’m still adjusting to a year since joining.  We talked about a common problem small software developer shops face: finding new and improved ways to reach the folks who need our services.  Among our whiteboarded solutions one thing became loudly apparent, we needed a new website.

Our current site was nice, but vague. So vague, that when I originally applied, I wasn’t entirely sure what it was I was applying for.  And that’s partly because we do a lot of things, every client is different after all, but also because our website just lacked information.  It hadn’t been updated with newer projects in a long time, and felt stale.  So, we decided to rewrite the site from scratch.
We started with around 3-4 google docs of similar-but-different buzzwords and projects and copy about how great we are.  Then we narrowed content to one document, made wireframes, wrote more content to fit the specific wireframes, and then it was my task to build it.  There were three main choices for the new website to be build on: Wordpress, Jekyll, or Gatsby. Wordpress had monthly costs and required an entire website rewrite, Jekyll didn’t require an entire rewrite but also wasn’t the most technically interesting route, so we landed with Gatsby.  I hadn’t heard of Gatsby until this project.  It was an appealing tool because it utilized [React](https://reactjs.org/) and [GraphQL](https://graphql.org), I have used the two but never together.

## Learning the Ropes With Gatsby
The initial set up was really quick. Gatsby has [some great tutorials](https://www.gatsbyjs.org/docs/) for getting a local environment set up and deployed.  It introduced me to [Surge](https://surge.sh/) which was a nifty tool for rapid deployment to show my team the site’s progress before setting up a real deployment pipeline.
The biggest difference in building this site from regular React apps was how Gatsby incorporates GraphQL.  In short, GraphQL is a query language for APIs.  The time I’ve used GraphQL in the past was for a larger scale Elixir backend project.  But for this new website project, I used it to [optimize image loading](https://codebushi.com/using-gatsby-image/), because it can generate thumbnails quickly before the full image is loaded.  I also used it to [find blog post markdown](https://medium.freecodecamp.org/how-to-build-a-react-and-gatsby-powered-blog-in-about-10-minutes-625c35c06481) files and convert them into blog posts like this one.  While it felt clunky at first to run queries to find images in my own repo, Gatsby has a [GraphQL endpoint](https://www.gatsbyjs.org/docs/querying-with-graphql/) so I could test my queries for images and posts locally in the browser for quick debugging and as a neat way to visually explore data.
It took me a bit of debugging to get used to.  Images are different in Gatsby, it comes with its own `Img` component which takes `fluid` or `fixed` instead of an image `src`, depending how you want to deal with displaying images. Sometimes it was easier to just get an image’s source and use the `img` tag instead.  One big issue I ran into was that it hates gifs, which cost me a few hours of debugging to discover when my templated blog posts were failing (a single blog post had a gif in it).  One thing I found useful when I was having trouble with queries was to use [static queries](https://www.gatsbyjs.org/docs/static-query).
When working with NPM, I often troubleshoot using `rm -rf node_modules`, it’s sort of my web-developer mantra.  With Gatsby, I replaced with with `rm -rm .cache`, though I didn’t use this much until I was closer to deploying the project.

## The Hard Parts
I’m gonna write about my failures with this project because it might help the next person, and it helps cement what I learned for myself. Problems I ran into:
The way CSS gets bundled makes using things like bootstrap a bit of a pain because they become hard to customize without breaking into using `global` and `!important`.  I really struggled with this lesson while making the quotes carousel, I started with a couple existing libraries which all failed, then I made a not-so-graceful one from scratch, then I replaced it with another recommended library and spent a while mucking in CSS to make it display at all (it didn’t help that the new library didn’t play nicely with flexbox).  Since I was the only one on the team using Gatsby, it was hard to get others up to speed on this in the right language so that I could pair and get help when I needed it.
Images, especially in the client box, got all sorts of weird if I used the wrong size, if it was bigger than the fluid/fixed given size then the image just wouldn’t show or I’d receive a hard-to-decipher error.  I ran into some issues with the generated blog posts and image displays, troubleshooting often came to just generating one post at a time until I could find the faulty one.  Also, did I mention that it **hates** gifs?  When rendering, it shows a lo-res preview of the image which is useful in larger sites with lots of images, but made our site look and feel slower instead.
Gatsby likes to hide the routing magic, making it harder to do custom routing with digging deeper than the standard React application. The nice side of this is I just needed to add a page to the `/pages` directory and it created the routing for me, the frustration came when I wanted to push to the url for SEO optimization but didn’t want to create the same page with slightly different information over and over in pages.


## The Finished Product
It took 120 hours for me to build the site from scratch.  I ran into problems with what I knew about web development outside of Gatsby (mobile-first design is a rough lesson to learn the hard way), and my CSS organizational skills were put to the test. But all in all, it was fun to get to pick up GraphQL again, and I always enjoy writing React components (to me, they’re the Legos of web development).  I think Gatsby probably shines on larger projects where fast loading with GraphQL pays off and I think using it for this project may have over complicated things, but I learned a lot in the process and I’d definitely use Gatsby again in the future.  Our website is now six pages instead of one (better for SEO), it has a lot more information about how we work and what we work on, and will hopefully help us find more clients that align with what we love doing.
